<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Tests for cichlid</title>

  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/ui-test.css">

  <script type="text/javascript" src="http://use.typekit.com/qnf5iux.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

</head>
<body>
  <div id="wrapper" class="butter-wrapper">
     

    <section id="stage" class="butter-stage">
      <div class="butter-embed-container">
  <!--
        <div id="media-source" class="butter-media-source">
           <a class="butter-btn-dark"><i class="icon icon-white icon-plus"></i> Add Video Source</a>
        </div>
    -->
        <div class="butter-video-container">
          <video id="video" preload data-butter="media" controls>
            <source src="http://ia700300.us.archive.org/9/items/nozon-test1/Nozon-test_512kb.mp4">
            <source src="http://ia700300.us.archive.org/9/items/nozon-test1/Nozon-test.ogv">
          </video>
        </div>
      </div>
    </section>
    <section id="editor" class="butter-editor">
       <header class="butter-editor-header">
          <ul>
            
            <li><a class="butter-btn-dark"><i class="icon icon-white icon-cog"></i>Settings</a></li>
            <li><a class="butter-btn-dark"><i class="icon icon-white icon-share"></i>Share</a></li>
            <li><a class="butter-btn-dark tooltip"><i class="icon icon-white icon-film"></i>Media
                <div class="butter-tooltip">
                  Blah blah blah blah Lorem ipsum dolor sit amet.
                </div>
            </a></li>
            <li><a class="butter-btn-dark butter-active"><i class="icon icon-white icon-plus"></i>Event</a></li>
          </ul>
        </header>
       
        <div class="butter-editor-outer">
          <div class="butter-editor-inner">  
            <h3>Add an event</h3>
            <fieldset class="btn-events-list">
                <a class="btn-light btn-events tooltip"><i class="icon-plugin plugin-text"></i>
                  Text
                  <div class="butter-tooltip">
                  Blah blah blah blah Lorem ipsum dolor sit amet.
                </div>
                </a>
                <a class="btn-light btn-events"><i class="icon-plugin plugin-link"></i>Link</a>
                <a class="btn-light btn-events"><i class="icon-plugin plugin-twitter"></i>Twitter</a>
                <a class="btn-light btn-events"><i class="icon-plugin plugin-image"></i>Image</a>
                <a class="btn-light btn-events"><i class="icon-plugin plugin-map"></i>Map</a>
                <a class="btn-light btn-events"><i class="icon-plugin plugin-toc"></i>Stuff</a>
            </fieldset>          
            <fieldset>
              <div class="ui-button-group ui-light">
                <a>This is a dropdown</a>
                <select name="stledas" id="myselect1">
                  <option val="jeldo">dasd</option>
                  <option val="dasda">d32fff</option>
                </select>
              </div>
            </fieldset>
            
          </div>
        </div>
    </section>
   <section id="tray" class="butter-tray">
    <div class="butter-tray-sidebar">
      <div class="butter-tray-sidebar-controls">
         <a class="butter-btn-dark butter-play-btn"><i class="icon icon-white icon-only icon-play"></i></a>
         <span class="butter-time"><span class="butter-current-time">15.42</span> / 24.13</span>
         <a class="butter-btn-dark butter-volume-btn"><i class="icon icon-white icon-only icon-volume-down"></i></a>
      </div>
      <div class="butter-tray-layers"></div>
    </div>
    <div class="butter-tracks-outer">
      <div id="butter-tracks-container" class="butter-tracks-container">
          
          <div id="butter-tracks" class="butter-tracks">
            <div id="controls" class="butter-controls">
              <div class="butter-controls-inner"></div>
            </div>
            <span id="butter-scrubber-large" class="butter-scrubber-large">
              <span class="butter-scrubber-head"></span>
            </span> 
           <ul></ul> 
          </div>
      </div>

      <div id="butter-visuals" class="butter-visuals">
        <div id="butter-controls-inner" class="butter-visuals-inner">
          <ul id="butter-visualization"></ul>
          <span id="butter-range" class="butter-range">  
          </span>
          <span id="butter-scrubber" class="butter-scrubber">
          </span> 
        </div>
      </div>
    </div>
  </section>


  </div>
<!--
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
-->
  <script src="js/libs/jquery.js"></script>
  <script src="js/libs/jquery.ui.js"></script>
  <script src="js/libs/jquery.localScroll.min.js"></script>
  <script src="js/script.js"></script>
  <script>
  document.addEventListener( "DOMContentLoaded", function(){

    var butter = {},
        i,
        l;

    butter.duration = 80;
    butter.tracks = [ 1, 2, 3 ];
    butter.orderedTrackEvents = [
      {
        track: 1,
        start: 3,
        end: 5
      },
      {
        track: 2,
        start: 10,
        end: 15
      },
      {
        track: 2,
        start: 24,
        end: 30
      },
      {
        track: 3,
        start: 24,
        end: 35
      },
      {
        track: 1,
        start: 67,
        end: 75
      }
    ];

    function addVisualizationEl( obj) {
      var dur = butter.duration,
          el,
          trackEl,
          ul = document.getElementById( "butter-visualization" ),
          tracks = document.querySelector( "#butter-tracks > ul" ),
          start = obj.start,
          end = obj.end,
          track = obj.track,
          totalTracks = butter.tracks.length;

      el = document.createElement( "li" );
      el.style.left = start / dur * 100 + "%";
      el.style.right = ( dur - end ) / dur * 100 + "%";
      el.style.top = track / totalTracks * 100 + "%";

      trackEl = el.cloneNode( "true" );

      ul.appendChild( el );
      tracks.appendChild( trackEl );

    }

    for ( i = 0, l = butter.orderedTrackEvents.length; i < l; i++ ) {
      addVisualizationEl( butter.orderedTrackEvents[ i ] );
    }

    var tracks = document.getElementById( "butter-tracks" ),
        tracksView = document.getElementById( "butter-tracks-container" ),
        viz = document.getElementById( "butter-visualization" ),
        vizWidth = viz.getBoundingClientRect().width,
        vizView = document.getElementById( "butter-range" ),
        scrubber = document.getElementById( "butter-scrubber-large" ),
        scrubberViz = document.getElementById( "butter-scrubber" );


    function trayToViewer( val ) {
      var tray = $( "#butter-tracks" ).width(),
          viewer = $( "#butter-controls-inner" ).width(),
          ratio = viewer / tray;

      return val * ratio;
    }

    function updateScrubbers() {
      var small = document.getElementById( "butter-scrubber" ),
          large = document.getElementById( "butter-scrubber-large" );

      small.style.left = large.style.left;

    }

    function resetView() {
      var vizViewWidth = vizView.getBoundingClientRect().width,
          vizViewLeft = vizView.style.left.replace( "px", "" ),
          tracksViewWidth = tracksView.getBoundingClientRect().width,
          newTracksWidth = tracksViewWidth * vizWidth / vizViewWidth,
          newLeft = vizViewLeft / vizWidth  * newTracksWidth;

          tracks.style.width = newTracksWidth + "px",
          $( tracksView ).scrollTo( newLeft, 0 );
    }

    $( ".butter-scrubber-large" ).draggable({ 
      axis: "x",
      containment: "#butter-controls-inner",
      drag: function( event, ui ) {
        var newScrubberPos = trayToViewer( ui.position.left );
        document.getElementById( "butter-scrubber" ).style.left = newScrubberPos + "px";

      },
      stop: function( event, ui ) {
        var total = $( "#butter-tracks" ).width(),
            endPos = ui.position.left,
            leftInPercent =  endPos/ total * 100 + "%";

        this.style.left = leftInPercent;
        document.getElementById( "butter-scrubber-large" ).style.left = leftInPercent;

      }
    });

    $( ".butter-range" ).draggable(
      { axis: "x",
      containment: "#butter-controls-inner",
      drag: function( event, ui ) {
        resetView( this );
      }
    }).resizable({ 
      handles: "e, w", 
      containment: "#butter-controls-inner",
      resize: function( event, ui ) {
        resetView( this );
      }
    });

    $( ".btn-events" ).draggable({
      helper: "clone",
      drag: function( event, ui ) {
        $( ".butter-video-container ").addClass("hover-state" );
      },
      stop: function( event, ui ){
        $( ".butter-video-container ").removeClass("hover-state" );
      }
    });

    $( ".btn-events-list" ).bind( "mouseover", function( e ) {
      $( ".butter-video-container ").addClass("hover-state" );
    });

    $( ".btn-events-list" ).bind( "mouseout", function( e ) {
      $( ".butter-video-container ").removeClass("hover-state" );
    });

  }, false);

  </script>
</body>
</html>
